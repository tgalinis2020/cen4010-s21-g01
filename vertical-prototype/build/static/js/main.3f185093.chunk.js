(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{39:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(25),c=n.n(i),s=n(11),u=n(7),o=n(26),l=n(28),h=n(18),j=n(17),d=n(27),b=n(9),f=n(10),O=n(23);var p=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="https://lamp.cse.fau.edu/~cen4010_s21_g01/api-v1.php".concat(e),a={method:t,headers:{"Content-Type":"application/json",Accept:"application/json"}};return["POST","PUT","PATCH"].includes(t)&&(a.body=JSON.stringify({data:n})),fetch(r,a)};var x=function(t){var e=t.split(" "),n=Object(u.a)(e,2),r=n[0],a=n[1],i=r.split("-"),c=Object(u.a)(i,3),s=c[0],o=c[1],l=c[2],h=a.split(":"),j=Object(u.a)(h,3),d=j[0],b=j[1],f=j[2];return new Date(Date.UTC(s,o,l,d,b,f))},v=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var y=function(t){var e=x(t);return"".concat(v[e.getDay()],", ").concat(g[e.getMonth()]," ").concat(e.getDate(),", ").concat(e.getFullYear())},m=n(1);var T=function(t){var e=t.user,n=t.onLogout,r=y(e.getAttribute("createdAt"));return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(O.a,{children:[Object(m.jsx)("img",{width:64,height:64,className:"mr-3",src:e.getAttribute("avatar"),alt:e.getAttribute("username")+"'s avatar"}),Object(m.jsxs)(O.a.Body,{children:[Object(m.jsxs)("h5",{children:[e.getAttribute("firstName")," ",e.getAttribute("lastName")," (",e.getAttribute("username"),")"]}),Object(m.jsxs)("p",{children:["Joined on ",r]})]})]}),Object(m.jsx)(f.a,{children:Object(m.jsx)(b.a,{onClick:function(){return p("DELETE","/session").then(n)},children:"Log out"})})]})},A=n(6),E=n(12),C=n(13),k=n(16),S=n(15),w=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(E.a)(this,t),this.id=e.id||null,this.attributes=e.attributes||{},this.dirtyAttributes=[],this.relationships=e.relationships||{}}return Object(C.a)(t,[{key:"type",get:function(){return"generic"}},{key:"hydrate",value:function(t){return this.id=t.id||null,this.attributes=t.attributes||{},this.relationships=t.relationships||{},this}},{key:"setAttribute",value:function(t,e){return this.dirtyAttributes.push(t),this.attributes[t]=e,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"toResourceIdentifier",value:function(){return{type:this.type,id:this.id}}},{key:"toResource",value:function(){return{type:this.type,id:this.id,attributes:this.attributes}}},{key:"create",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r={},a=Object(s.a)(this.dirtyAttributes);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i]=this.attributes[i]}}catch(u){a.e(u)}finally{a.f()}var c={type:this.type,attributes:r};return null!==n&&(c.relationships=n),console.log(c),p("POST","/".concat(this.type),c).then((function(t){return e.dirtyAttributes=[],t.json()})).then((function(t){return t.data}))}},{key:"update",value:function(){var t,e=this,n={},r=Object(s.a)(this.dirtyAttributes);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a]=this.attributes[a]}}catch(c){r.e(c)}finally{r.f()}var i={type:this.type,id:this.id,attributes:n};return p("PATCH","/".concat(this.type,"/").concat(this.id),i).then((function(){return e.dirtyAttributes=[],e}))}},{key:"delete",value:function(){return p("DELETE","/".concat(this.type,"/").concat(this.id))}},{key:"updateRelationship",value:function(t,e,n){return p(t,"/".concat(this.type,"/").concat(this.id,"/relationships/").concat(e),n)}},{key:"updateToManyRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.map((function(t){return t.toResourceIdentifier()})))}},{key:"updateToOneRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.toResourceIdentifier())}}]),t}(),P=function(t){Object(k.a)(n,t);var e=Object(S.a)(n);function n(){return Object(E.a)(this,n),e.apply(this,arguments)}return Object(C.a)(n,[{key:"type",get:function(){return"users"}},{key:"create",value:function(t){var e,n=this,r=this.type,a={},i=Object(s.a)(this.dirtyAttributes);try{for(i.s();!(e=i.n()).done;){var c=e.value;a[c]=this.attributes[c]}}catch(u){i.e(u)}finally{i.f()}return p("POST","/".concat(r),{type:r,attributes:a}).then((function(t){return t.json()})).then((function(e){var r=e.data;return console.log(r),n.hydrate(r),p("PUT","/passwords/".concat(r.id),t)})).then((function(t){return n}))}},{key:"updatePassword",value:function(t,e){return p("PATCH","/passwords/".concat(this.id),{current:t,password:e})}},{key:"login",value:function(t){return p("POST","/session",{username:this.getAttribute("username"),password:t})}},{key:"logout",value:function(){return p("DELETE","/session")}},{key:"subscribeTo",value:function(t){return this.updateToManyRelationship("POST","subscriptions",[t])}},{key:"unsubscribeFrom",value:function(t){return this.updateToManyRelationship("DELETE","subscriptions",[t])}},{key:"addFavorite",value:function(t){return this.updateToManyRelationship("POST","favorites",[t])}},{key:"removeFavorite",value:function(t){return this.updateToManyRelationship("DELETE","favorites",[t])}},{key:"like",value:function(t){return this.updateToManyRelationship("POST","liked-posts",[t])}},{key:"unlike",value:function(t){return this.updateToManyRelationship("DELETE","liked-posts",[t])}}]),n}(w);var L=function(t){var e=new FormData;return e.append("data",t,t.name),fetch("https://lamp.cse.fau.edu/~cen4010_s21_g01/api-v1.php/upload",{method:"POST",body:e})};var R=function(t){var e=t.onRegistered,n=t.onError,a=Object(r.useState)(""),i=Object(u.a)(a,2),c=i[0],s=i[1],o=Object(r.useState)(""),l=Object(u.a)(o,2),h=l[0],j=l[1],d=Object(r.useState)(""),O=Object(u.a)(d,2),x=O[0],v=O[1],g=Object(r.useState)(""),y=Object(u.a)(g,2),T=y[0],E=y[1],C=Object(r.useState)(""),k=Object(u.a)(C,2),S=k[0],w=k[1],R=Object(r.useState)(null),G=Object(u.a)(R,2),N=G[0],D=G[1],F=new P;return Object(m.jsxs)(A.a,{children:[Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"First Name"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter first name",onChange:function(t){return v(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Last Name"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter last name",onChange:function(t){return E(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"E-mail Address"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter e-mail address",onChange:function(t){return w(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Username"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter username",onChange:function(t){return s(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Password"}),Object(m.jsx)(A.a.Control,{type:"password",placeholder:"Enter password",onChange:function(t){return j(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Avatar"}),Object(m.jsx)(A.a.File,{custom:!0,label:"Upload an image",onChange:function(t){return D(t.target.files.item(0))}})]}),Object(m.jsx)(f.a,{children:Object(m.jsx)(b.a,{variant:"primary",onClick:function(){return F.setAttribute("firstName",x).setAttribute("lastName",T).setAttribute("email",S).setAttribute("username",c).create(h).then((function(){return p("POST","/session",{username:c,password:h})})).then((function(){return L(N)})).then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){return F.setAttribute("avatar",t)})).then((function(t){return t.update()})).then(e).catch(n)},children:"Register"})})]})},G=n(29),N=n(14),D=function(t){Object(k.a)(n,t);var e=Object(S.a)(n);function n(){return Object(E.a)(this,n),e.apply(this,arguments)}return Object(C.a)(n,[{key:"type",get:function(){return"tags"}}]),n}(w),F=function(t){Object(k.a)(n,t);var e=Object(S.a)(n);function n(){return Object(E.a)(this,n),e.apply(this,arguments)}return Object(C.a)(n,[{key:"type",get:function(){return"posts"}},{key:"create",value:function(){var t,e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c={},u=Object(s.a)(a);try{for(u.s();!(t=u.n()).done;){var o=t.value;c[o]=!1}}catch(l){u.e(l)}finally{u.f()}return p("GET","/tags?filter[text][in]=".concat(a.join(","))).then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){var e,n=[],r=Object(s.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,u=new D(i);c[u.getAttribute("text")]=!0,n.push(u)}}catch(l){r.e(l)}finally{r.f()}var o=a.filter((function(t){return!1===c[t]}));return o.length>0?Promise.all(o.map((function(t){return p("POST","/tags",{type:"tags",attributes:{text:t}})}))).then((function(t){return t.map((function(t){return new D(t.json().data)}))})).then((function(t){return n.concat(t)})):new Promise((function(t,e){return t(n)}))})).then((function(t){var e={},n=0;return null!==r&&(e.author={data:r.toResourceIdentifier()},n++),i.length>0&&(e.pets={data:i.map((function(t){return t.toResourceIdentifier()}))},n++),t.length>0&&(e.tags={data:t.map((function(t){return t.toResourceIdentifier()}))},n++),n>0?e:null})).then((function(t){return Object(G.a)(Object(N.a)(n.prototype),"create",e).call(e,t)})).then((function(t){return e.hydrate(t)}))}}]),n}(w);var M=function(t){var e=t.user,n=t.onPostCreated,a=Object(r.useState)(""),i=Object(u.a)(a,2),c=i[0],s=i[1],o=Object(r.useState)(null),l=Object(u.a)(o,2),h=l[0],j=l[1],d=Object(r.useState)(""),O=Object(u.a)(d,2),p=O[0],x=O[1],v=Object(r.useState)(""),g=Object(u.a)(v,2),y=g[0],T=g[1];return Object(m.jsxs)(A.a,{children:[Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Title"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter post title",onChange:function(t){var e=t.target;return s(e.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Image"}),Object(m.jsx)(A.a.File,{custom:!0,label:"Upload an image",onChange:function(t){var e=t.target;return j(e.files.item(0))}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Text"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter post text",onChange:function(t){var e=t.target;return x(e.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Tags"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter commea-separated tags",onChange:function(t){var e=t.target;return T(e.value)}})]}),Object(m.jsx)(f.a,{children:Object(m.jsx)(b.a,{onClick:function(){if(null!==h){var t=y.split(",").map((function(t){return t.trim().toLowerCase()}));L(h).then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){return new F({attributes:{title:c,text:p,image:t}})})).then((function(n){return n.create(e,t,[])})).then(n)}},children:"Create"})})]})};var I=function(t){return function(e){if(e.status!==t)throw e.status;return e.json()}};var U=function(t){var e=t.onSuccess,n=t.onError,a=Object(r.useState)(""),i=Object(u.a)(a,2),c=i[0],s=i[1],o=Object(r.useState)(""),l=Object(u.a)(o,2),h=l[0],j=l[1];return Object(m.jsxs)(A.a,{children:[Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Username"}),Object(m.jsx)(A.a.Control,{type:"text",placeholder:"Enter username",onChange:function(t){return s(t.target.value)}})]}),Object(m.jsxs)(A.a.Group,{children:[Object(m.jsx)(A.a.Label,{children:"Password"}),Object(m.jsx)(A.a.Control,{type:"password",placeholder:"Enter password",onChange:function(t){return j(t.target.value)}})]}),Object(m.jsx)(f.a,{children:Object(m.jsx)(b.a,{variant:"primary",onClick:function(){return p("POST","/session",{username:c,password:h}).then(I(201)).then((function(t){return t.data})).then((function(t){var e=t.uid;return p("GET","/users/".concat(e))})).then((function(t){return t.json()})).then((function(t){return new P(t.data)})).then(e).catch(n)},children:"Log In"})})]})};var J=function(){var t=Object(r.useState)([]),e=Object(u.a)(t,2),n=e[0],a=e[1],i=Object(r.useState)([]),c=Object(u.a)(i,2),O=c[0],x=c[1],v=Object(r.useState)(null),g=Object(u.a)(v,2),A=g[0],E=g[1],C=function(){return p("GET","/users").then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){return t.map((function(t){return new P(t)}))})).then(a)},k=function(){return p("GET","/posts?include=author,tags&fields[users]=username").then((function(t){return t.json()})).then((function(t){var e,n=t.data,r=t.included,a=[],i=Object(s.a)(n);try{var c=function(){var t=e.value,n=t.attributes,i=t.relationships,c={tags:i.tags.data.map((function(t){return t.id})),author:i.author.data.id};a.push({image:n.image,title:n.title,text:n.text,createdAt:y(n.createdAt),author:r.find((function(t){return"users"===t.type&&t.id===c.author})).attributes.username,tags:r.filter((function(t){return"tags"===t.type&&c.tags.includes(t.id)})).map((function(t){return"#".concat(t.attributes.text)}))})};for(i.s();!(e=i.n()).done;)c()}catch(u){i.e(u)}finally{i.f()}return a})).then(x)};return Object(r.useEffect)((function(){C(),k(),p("GET","/session").then((function(t){return t.json()})).then((function(t){return t.data.uid})).then((function(t){return p("GET","/users/".concat(t)).then((function(t){return t.json()})).then((function(t){return new P(t.data)}))})).then(E).catch((function(t){return console.log("Not logged in")}))}),[E]),Object(m.jsxs)(o.a,{children:[Object(m.jsx)("h1",{children:"Users and Authentication"}),Object(m.jsx)(b.a,{className:"mb-4",onClick:function(){return C()},children:"Refresh"}),Object(m.jsxs)(d.a,{children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"ID"}),Object(m.jsx)("th",{children:"Username"}),Object(m.jsx)("th",{children:"E-mail Address"}),Object(m.jsx)("th",{children:"First Name"}),Object(m.jsx)("th",{children:"Last Name"}),Object(m.jsx)("th",{children:"Joined On"})]})}),Object(m.jsx)("tbody",{children:n.map((function(t,e){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{children:t.id}),Object(m.jsx)("td",{children:t.getAttribute("username")}),Object(m.jsx)("td",{children:t.getAttribute("email")}),Object(m.jsx)("td",{children:t.getAttribute("firstName")}),Object(m.jsx)("td",{children:t.getAttribute("lastName")}),Object(m.jsx)("td",{children:t.getAttribute("createdAt")})]},e)}))})]}),A?Object(m.jsx)(T,{user:A,onLogout:function(){return E(null)}}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(U,{onSuccess:E,onError:function(t){return window.alert("Can't log in! (error: ".concat(t,")"))}}),Object(m.jsx)("p",{children:"Don't have an account? Create one!"}),Object(m.jsx)(R,{onRegistered:E,onError:console.error})]}),Object(m.jsx)("hr",{}),Object(m.jsx)("h1",{children:"Posts"}),Object(m.jsx)(f.a,{children:Object(m.jsx)(b.a,{onClick:function(){return k()},children:"Refresh"})}),Object(m.jsx)(l.a,{children:O.map((function(t){return Object(m.jsx)(h.a,{xs:1,sm:2,md:3,lg:4,children:Object(m.jsxs)(j.a,{children:[Object(m.jsx)(j.a.Img,{src:t.image}),Object(m.jsxs)(j.a.Body,{children:[Object(m.jsx)(j.a.Title,{children:t.title}),Object(m.jsxs)(j.a.Text,{children:[Object(m.jsxs)("small",{className:"text-muted",children:["Posted by ",t.author," on ",t.createdAt]}),Object(m.jsx)("p",{children:t.text}),Object(m.jsxs)("p",{className:"text-muted",children:["Tags: ",t.tags.join(", ")]})]})]})]})})}))}),A&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h3",{children:"Create Post"}),Object(m.jsx)(M,{user:A,onPostCreated:function(){return k()}})]})]})};n(38);c.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(J,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.3f185093.chunk.js.map