(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{39:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(25),s=n.n(i),u=n(10),c=n(7),o=n(26),h=n(28),l=n(18),d=n(17),j=n(27),b=n(9),p=n(11),f=n(23);var O=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r="https://lamp.cse.fau.edu/~cen4010_s21_g01/api-v1.php".concat(e),a={method:t,headers:{"Content-Type":"application/json",Accept:"application/json"}};return["POST","PUT","PATCH"].includes(t)&&(a.body=JSON.stringify({data:n})),fetch(r,a)};var y=function(t){var e=t.split(" "),n=Object(c.a)(e,2),r=n[0],a=n[1],i=r.split("-"),s=Object(c.a)(i,3),u=s[0],o=s[1],h=s[2],l=a.split(":"),d=Object(c.a)(l,3),j=d[0],b=d[1],p=d[2];return Date.UTC(h,o,u,j,b,p)},v=n(1);var x=function(t){var e=t.user,n=t.onLogout,r=y(e.getAttribute("createdAt"));return Object(v.jsxs)(f.a,{children:[Object(v.jsx)("img",{width:64,height:64,className:"mr-3",src:e.getAttribute("avatar"),alt:e.getAttribute("username")+"'s avatar"}),Object(v.jsxs)(f.a.Body,{children:[Object(v.jsxs)("h5",{children:[e.getAttribute("firstName")," ",e.getAttribute("lastName")," (",e.getAttribute("username"),")"]}),Object(v.jsxs)("p",{children:["Joined on ",r]}),Object(v.jsx)(p.a,{children:Object(v.jsx)(b.a,{onClick:function(){return O("DELETE","/session").then(n)},children:"Log out"})})]})]})},g=n(5),m=n(12),A=n(13),T=n(16),k=n(15),E=function(){function t(e){Object(m.a)(this,t),this.id=e.id||null,this.attributes=e.attributes||{},this.dirtyAttributes=[],this.relationships=e.relationships||{},"createdAt"in this.attributes&&(this.createdAt=y(this.attributes.createdAt))}return Object(A.a)(t,[{key:"type",get:function(){return"generic"}},{key:"hydrate",value:function(t){return this.id=t.id||null,this.attributes=t.attributes||{},this.relationships=t.relationships||{},"createdAt"in this.attributes&&(this.createdAt=y(this.attributes.createdAt)),this}},{key:"setAttribute",value:function(t,e){return this.dirtyAttributes.push(t),this.attributes[t]=e,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"toResourceIdentifier",value:function(){return{type:this.type,id:this.id}}},{key:"toResource",value:function(){return{type:this.type,id:this.id,attributes:this.attributes}}},{key:"create",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r={},a=Object(u.a)(this.dirtyAttributes);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i]=this.attributes[i]}}catch(c){a.e(c)}finally{a.f()}var s={type:this.type,attributes:r};return null!==n&&(s.relationships=n),O("POST","/".concat(this.type),s).then((function(t){return e.dirtyAttributes=[],t.json()})).then((function(t){return t.data}))}},{key:"update",value:function(){var t,e=this,n={},r=Object(u.a)(this.dirtyAttributes);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a]=this.attributes[a]}}catch(s){r.e(s)}finally{r.f()}var i={type:this.type,id:this.id,attributes:n};return O("PATCH","/".concat(this.type),i).then((function(){return e.dirtyAttributes=[],e}))}},{key:"delete",value:function(){return O("DELETE","/".concat(this.type,"/").concat(this.id))}},{key:"updateRelationship",value:function(t,e,n){return O(t,"/".concat(this.type,"/").concat(this.id,"/relationships/").concat(e),n)}},{key:"updateToManyRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.map((function(t){return t.toResourceIdentifier()})))}},{key:"updateToOneRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.toResourceIdentifier())}}]),t}(),C=function(t){Object(T.a)(n,t);var e=Object(k.a)(n);function n(){return Object(m.a)(this,n),e.apply(this,arguments)}return Object(A.a)(n,[{key:"type",get:function(){return"users"}},{key:"create",value:function(t){var e=this;return O("POST","/".concat(this.type),{type:this.type,attributes:this.attributes}).then((function(n){return e.hydrate(n.data),O("PUT","/passwords/".concat(n.data.id),t)})).then((function(t){return e}))}},{key:"updatePassword",value:function(t,e){return O("PATCH","/passwords/".concat(this.id),{current:t,password:e})}},{key:"login",value:function(t){return O("POST","/session",{username:this.getAttribute("username"),password:t})}},{key:"logout",value:function(){return O("DELETE","/session")}},{key:"subscribeTo",value:function(t){return this.updateToManyRelationship("POST","subscriptions",[t])}},{key:"unsubscribeFrom",value:function(t){return this.updateToManyRelationship("DELETE","subscriptions",[t])}},{key:"addFavorite",value:function(t){return this.updateToManyRelationship("POST","favorites",[t])}},{key:"removeFavorite",value:function(t){return this.updateToManyRelationship("DELETE","favorites",[t])}},{key:"like",value:function(t){return this.updateToManyRelationship("POST","liked-posts",[t])}},{key:"unlike",value:function(t){return this.updateToManyRelationship("DELETE","liked-posts",[t])}}]),n}(E);var S=function(t){var e=new FormData;return e.append("data",t,t.name),fetch("https://lamp.cse.fau.edu/~cen4010_s21_g01/api-v1.php/upload",{method:"POST",body:e})};var R=function(t){var e=t.onRegistered,n=t.onError,a=Object(r.useState)(""),i=Object(c.a)(a,2),s=i[0],u=i[1],o=Object(r.useState)(""),h=Object(c.a)(o,2),l=h[0],d=h[1],j=Object(r.useState)(""),f=Object(c.a)(j,2),y=f[0],x=f[1],m=Object(r.useState)(""),A=Object(c.a)(m,2),T=A[0],k=A[1],E=Object(r.useState)(""),R=Object(c.a)(E,2),w=R[0],P=R[1],L=Object(r.useState)(null),G=Object(c.a)(L,2),N=G[0],I=G[1],D=new C;return Object(v.jsxs)(g.a,{children:[Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"First Name"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter first name",onChange:function(t){return x(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Last Name"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter last name",onChange:function(t){return k(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"E-mail Address"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter e-mail address",onChange:function(t){return P(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Username"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter username",onChange:function(t){return u(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Password"}),Object(v.jsx)(g.a.Control,{type:"password",placeholder:"Enter password",onChange:function(t){return d(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Avatar"}),Object(v.jsx)(g.a.File,{custom:!0,label:"Upload an image",onChange:function(t){return I(t.target.files.item(0))}})]}),Object(v.jsx)(p.a,{children:Object(v.jsx)(b.a,{variant:"primary",onClick:function(){return D.setAttribute("firstName",y).setAttribute("lastName",T).setAttribute("email",w).setAttribute("username",s).create(l).then((function(){return O("POST","/session",{username:s,password:l})})).then((function(){return S(N)})).then((function(t){return t.json()})).then((function(t){return t.data()})).then((function(t){return D.setAttribute("avatar",t)})).then((function(t){return t.update()})).then(e).catch(n)},children:"Register"})})]})},w=n(29),P=n(14),L=function(t){Object(T.a)(n,t);var e=Object(k.a)(n);function n(){return Object(m.a)(this,n),e.apply(this,arguments)}return Object(A.a)(n,[{key:"type",get:function(){return"tags"}}]),n}(function(){function t(e){Object(m.a)(this,t),this.id=e.id||null,this.attributes=e.attributes||{},this.dirtyAttributes=[],this.relationships=e.relationships||{},"createdAt"in this.attributes&&(this.createdAt=y(this.attributes.createdAt))}return Object(A.a)(t,[{key:"type",get:function(){return"generic"}},{key:"hydrate",value:function(t){return this.id=t.id||null,this.attributes=t.attributes||{},this.relationships=t.relationships||{},"createdAt"in this.attributes&&(this.createdAt=y(this.attributes.createdAt)),this}},{key:"setAttribute",value:function(t,e){return this.dirtyAttributes.push(t),this.attributes[t]=e,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"toResourceIdentifier",value:function(){return{type:this.type,id:this.id}}},{key:"toResource",value:function(){return{type:this.type,id:this.id,attributes:this.attributes}}},{key:"create",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r={},a=Object(u.a)(this.dirtyAttributes);try{for(a.s();!(t=a.n()).done;){var i=t.value;r[i]=this.attributes[i]}}catch(c){a.e(c)}finally{a.f()}var s={type:this.type,attributes:r};return null!==n&&(s.relationships=n),O("POST","/".concat(this.type),s).then((function(t){return e.dirtyAttributes=[],t.json()})).then((function(t){return t.data}))}},{key:"update",value:function(){var t,e=this,n={},r=Object(u.a)(this.dirtyAttributes);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a]=this.attributes[a]}}catch(s){r.e(s)}finally{r.f()}var i={type:this.type,id:this.id,attributes:n};return O("PATCH","/".concat(this.type),i).then((function(){return e.dirtyAttributes=[],e}))}},{key:"delete",value:function(){return O("DELETE","/".concat(this.type,"/").concat(this.id))}},{key:"updateRelationship",value:function(t,e,n){return O(t,"/".concat(this.type,"/").concat(this.id,"/relationships/").concat(e),n)}},{key:"updateToManyRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.map((function(t){return t.toResourceIdentifier()})))}},{key:"updateToOneRelationship",value:function(t,e,n){return this.updateRelationship(t,e,n.toResourceIdentifier())}}]),t}()),G=function(t){Object(T.a)(n,t);var e=Object(k.a)(n);function n(){return Object(m.a)(this,n),e.apply(this,arguments)}return Object(A.a)(n,[{key:"type",get:function(){return"posts"}},{key:"create",value:function(){var t,e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s={},c=Object(u.a)(a);try{for(c.s();!(t=c.n()).done;){var o=t.value;s[o]=!1}}catch(h){c.e(h)}finally{c.f()}return O("GET","/tags?filter[text][in]=".concat(a.map((function(t){return t.getAttribute("text")})).join(","))).then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){var e,n=[],r=Object(u.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,c=new L(i);s[c.getAttribute("text")]=!0,n.append(c)}}catch(h){r.e(h)}finally{r.f()}var o=a.filter((function(t){return!(t.getAttribute("text")in s)}));return o.length>0?Promise.all(o.map((function(t){return O("POST","/tags",t.toResourceIdentifier())}))).then((function(t){return t.map((function(t){return new L(t.json().data)}))})).then((function(t){return n.concat(t)})):new Promise((function(t,e){return t(n)}))})).then((function(t){var e={},n=0;return null!==r&&(e.author={data:r.toResourceIdentifier()},n++),i.length>0&&(e.pets={data:i.map((function(t){return t.toResourceIdentifier()}))},n++),t.length>0&&(e.tags={data:t.map((function(t){return t.toResourceIdentifier()}))},n++),n>0?e:null})).then((function(t){return Object(w.a)(Object(P.a)(n.prototype),"create",e).call(e,t)})).then((function(t){return e.hydrate(t)}))}}]),n}(E);var N=function(t){var e=t.user,n=t.onPostCreated,a=Object(r.useState)(""),i=Object(c.a)(a,2),s=i[0],u=i[1],o=Object(r.useState)(null),h=Object(c.a)(o,2),l=h[0],d=h[1],j=Object(r.useState)(""),f=Object(c.a)(j,2),O=f[0],y=f[1],x=Object(r.useState)(""),m=Object(c.a)(x,2),A=m[0],T=m[1];return Object(v.jsxs)(g.a,{children:[Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Title"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter post title",onChange:function(t){var e=t.target;return u(e.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Image"}),Object(v.jsx)(g.a.File,{custom:!0,label:"Upload an image",onChange:function(t){var e=t.target;return d(e.files.item(0))}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Text"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter post text",onChange:function(t){var e=t.target;return y(e.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Tags"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter commea-separated tags",onChange:function(t){var e=t.target;return T(e.value)}})]}),Object(v.jsx)(p.a,{children:Object(v.jsx)(b.a,{onClick:function(){if(null!==l){var t=A.split(",").map((function(t){return t.trim().toLowerCase()}));S(l).then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){return new G({attributes:{title:s,text:O,image:t}})})).then((function(n){return n.create(e,t,[])})).then(n)}},children:"Create"})})]})};var I=function(t){return function(e){if(e.status!==t)throw e.status;return e.json()}};var D=function(t){var e=t.onSuccess,n=t.onError,a=Object(r.useState)(""),i=Object(c.a)(a,2),s=i[0],u=i[1],o=Object(r.useState)(""),h=Object(c.a)(o,2),l=h[0],d=h[1];return Object(v.jsxs)(g.a,{children:[Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Username"}),Object(v.jsx)(g.a.Control,{type:"text",placeholder:"Enter username",onChange:function(t){return u(t.target.value)}})]}),Object(v.jsxs)(g.a.Group,{children:[Object(v.jsx)(g.a.Label,{children:"Password"}),Object(v.jsx)(g.a.Control,{type:"password",placeholder:"Enter password",onChange:function(t){return d(t.target.value)}})]}),Object(v.jsx)(p.a,{children:Object(v.jsx)(b.a,{variant:"primary",onClick:function(){return O("POST","/session",{username:s,password:l}).then(I).then((function(t){return t.data})).then((function(t){var e=t.uid;return O("GET","/users/".concat(e))})).then((function(t){return t.json()})).then((function(t){return new C(t.data)})).then(e).catch(n)},children:"Log In"})})]})},M=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var U=function(t){var e=y(t);return"".concat(M[e.getDay()],", ").concat(F[e.getMonth()]," ").concat(e.getDate(),", ").concat(e.getFullYear())};var J=function(){var t=Object(r.useState)(null),e=Object(c.a)(t,2),n=(e[0],e[1],Object(r.useState)([])),a=Object(c.a)(n,2),i=a[0],s=a[1],f=Object(r.useState)([]),y=Object(c.a)(f,2),g=y[0],m=y[1],A=Object(r.useState)(null),T=Object(c.a)(A,2),k=(T[0],T[1],Object(r.useState)(null)),E=Object(c.a)(k,2),S=E[0],w=E[1],P=function(){return O("GET","/users").then((function(t){return t.json()})).then((function(t){return t.data})).then((function(t){return t.map((function(t){return new C(t)}))})).then(s)},L=function(){return O("GET","/posts?include=author,tags&fields[users]=username").then((function(t){return t.json()})).then((function(t){var e,n=t.data,r=t.included,a=[],i=Object(u.a)(n);try{var s=function(){var t=e.value,n=(t.id,t.type,t.attributes),i=t.relationships,s={tags:i.tags.data.map((function(t){return t.id})),author:i.author.data.id};a.push({image:n.image,title:n.title,text:n.text,createdAt:U(n.createdAt),author:r.find((function(t){return"users"===t.type&&t.id===s.author})).attributes.username,tags:r.filter((function(t){return"tags"===t.type&&s.tags.includes(t.id)})).map((function(t){return"#".concat(t.attributes.text)}))})};for(i.s();!(e=i.n()).done;)s()}catch(c){i.e(c)}finally{i.f()}return a})).then(m)};return Object(r.useEffect)((function(){P(),L(),O("GET","/session").then((function(t){return t.json()})).then((function(t){return t.data.uid})).then((function(t){return O("GET","/users/".concat(t)).then((function(t){return t.json()})).then((function(t){return new C(t.data)}))})).then(w).catch((function(t){return console.log("Not logged in")}))}),[w]),Object(v.jsxs)(o.a,{children:[Object(v.jsx)("h1",{children:"Users and Authentication"}),Object(v.jsx)(b.a,{className:"mb-4",onClick:P,children:"Refresh"}),Object(v.jsxs)(j.a,{children:[Object(v.jsx)("thead",{children:Object(v.jsxs)("tr",{children:[Object(v.jsx)("th",{children:"ID"}),Object(v.jsx)("th",{children:"Username"}),Object(v.jsx)("th",{children:"E-mail Address"}),Object(v.jsx)("th",{children:"First Name"}),Object(v.jsx)("th",{children:"Last Name"}),Object(v.jsx)("th",{children:"Joined On"})]})}),Object(v.jsx)("tbody",{children:i.map((function(t,e){return Object(v.jsxs)("tr",{children:[Object(v.jsx)("td",{children:t.id}),Object(v.jsx)("td",{children:t.getAttribute("username")}),Object(v.jsx)("td",{children:t.getAttribute("email")}),Object(v.jsx)("td",{children:t.getAttribute("firstName")}),Object(v.jsx)("td",{children:t.getAttribute("lastName")}),Object(v.jsx)("td",{children:t.getAttribute("createdAt")})]},e)}))})]}),S?Object(v.jsx)(x,{user:S}):Object(v.jsx)(D,{onSuccess:w,onError:function(t){return window.alert("Can't log in! (error: ".concat(t,")"))}}),Object(v.jsx)("p",{children:"Don't have an account? Create one!"}),Object(v.jsx)(R,{onRegistered:w,onError:console.error}),Object(v.jsx)("hr",{}),Object(v.jsx)("h1",{children:"Posts"}),Object(v.jsx)(p.a,{children:Object(v.jsx)(b.a,{onClick:function(){return L()},children:"Refresh"})}),Object(v.jsx)(h.a,{children:g.map((function(t){return Object(v.jsx)(l.a,{xs:1,sm:2,md:3,lg:4,children:Object(v.jsxs)(d.a,{children:[Object(v.jsx)(d.a.Img,{src:t.image}),Object(v.jsxs)(d.a.Body,{children:[Object(v.jsx)(d.a.Title,{children:t.title}),Object(v.jsxs)(d.a.Text,{children:[Object(v.jsxs)("small",{className:"text-muted",children:["Posted By ",g.author," on ",g.createdAt]}),Object(v.jsx)("p",{children:t.text}),Object(v.jsxs)("p",{className:"text-muted",children:["Tags: ",t.tags.join(", ")]})]})]})]})})}))}),S&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h3",{children:"Create Post"}),Object(v.jsx)(N,{user:S,onPostCreated:function(){return L()}})]})]})};n(38);s.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(J,{})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.921a8bf5.chunk.js.map